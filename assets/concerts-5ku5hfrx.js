import{k as S,am as c,al as a,a$ as $,ah as f,aC as k,ac as P}from"./index-bAjc-hai.js";import{h as g}from"./moment-WSJ9un1t.js";const Y=()=>{let t;const e=S(null);return{state:t,err:e,timeCountryFilter:async(n,r="",l="",h="",m=1)=>{const u=r==="本日"?"day":r==="本週"?"week":"month",d=g().startOf(u).format("YYYY-MM-DD"),y=g().endOf(u).format("YYYY-MM-DD");let p=(n==="concerts"?c.concerts:c.artists)+"?";const b=`start=${d}&end=${y}`,v=`country=${l}`,C=`q=${h}`,x=`page=${m}`,s=[];return h!==""&&s.push(C),l!==""&&s.push(v),r!==""&&s.push(b),s.push(x),p+=s.join("&"),new Promise((w,F)=>{a.get(p).then(i=>{console.log(i),t=i.data,w(t)}).catch(i=>{console.log(i),e.value=i,F(e)})})}}};function B(){return{swalWithStylingButtons:$.mixin({customClass:{popup:"px-6 py-10 rounded-md bg-black-90 text-white text-nowrap",confirmButton:"mt-4 mr-2 whitespace-nowrap focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border-[3px] border-tiffany bg-tiffany text-primary p-2 md:py-2 md:px-4 lg:py-2 lg:px-6 rounded-btn1",cancelButton:"mt-4 ml-2 whitespace-nowrap focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border-[3px] border-black-80 bg-black-80 text-primary text-white p-2 md:py-2 md:px-4 lg:py-2 lg:px-6 rounded-btn1"},buttonsStyling:!1})}}const{timeCountryFilter:D}=Y(),{getUserSavedAndFollowed:T}=f(),{swalWithStylingButtons:U}=B(),O=k("concerts",{state:()=>({concerts:[],singleConcert:{},pagination:{},timeFactor:"",countryFactor:"",textFactor:"",pageFactor:""}),actions:{searchConcerts:P(function(t){this.textFactor=t,this.getConcerts()},300),getConcerts(t,e,o=1){t==="time"&&(e==="all"?this.timeFactor="":this.timeFactor=e),t==="country"&&(e==="all"?this.countryFactor="":this.countryFactor=e),this.pageFactor=o,D("concerts",this.timeFactor,this.countryFactor,this.textFactor,this.pageFactor).then(n=>{console.log("concerts",this.timeFactor,this.countryFactor,this.textFactor,this.pageFactor),this.concerts=n.data,this.pagination=n.pagination})},getSingleConcert(t){a.get(`${c.concerts}/${t}`).then(e=>{this.singleConcert=e.data.data}).catch(e=>{console.log(e)})},saveUnSavedConcert(t,e){a[t](`${c.concerts}/${e}/${t==="post"?"save":"unsave"}`).then(o=>{console.log(o)}).then(()=>{T()}).catch(o=>{console.log(o)})},callSaveAction(t){const{savedConcerts:e,AccessToken:o}=f();if(o===void 0){U.fire({title:"登入後才能用收藏功能喔！",showCancelButton:!0,confirmButtonText:"前往登入"}).then(n=>{n.isConfirmed&&(window.location.href="https://gingene.github.io/Concert-now/#/login")});return}[...e].some(n=>n.id===t)?this.saveUnSavedConcert("delete",t):this.saveUnSavedConcert("post",t)}}});export{B as a,O as u};
