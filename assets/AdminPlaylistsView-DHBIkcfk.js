import{o,c as u,O as Y,u as e,v as L,a as g,w as l,d as s,U as Q,t as X,V as Z,W as K,j as ee,X as se,Z as le,_ as te,B as S,F as y,e as f,C as p,l as ae,G as ne,J as ie,I as ce,S as oe,m as re,i as ue,T as de,Q as fe,R as _e,f as n,g as h,$ as he,L as pe,N as me,r as ge,Y as ke}from"./index-dLv6FbVa.js";import{_ as A,a as ve,b as ye}from"./PaginationLast-0zDtQ_s0.js";import{u as we,_ as Se}from"./Input-oq2sWXSw.js";import{_ as $e,a as Ce,b as be}from"./PaginationPrev-VQXf2Xfl.js";import{_ as D,a as R,b as B,c as I,d as q,f as w,e as V,g as xe,h as b,i as k,j as Le,l as Ae,k as r}from"./SelectLabel-siURMYq9.js";import{_ as De}from"./TableCaption-oVamgBht.js";import{_ as Re,a as Be,b as j,c as E,d as T,e as U,f as N,g as Ie,h as qe,i as z,j as M,k as G,l as O,m as P,n as W,o as Ve,p as F}from"./AlertDialogCancel-0zertW4_.js";import"./createLucideIcon-Wabha9vT.js";import"./x-nD26nPMq.js";const v={__name:"Skeleton",props:{class:{type:String,required:!1}},setup(a){const t=a;return(i,d)=>(o(),u("div",{class:Y(e(L)("animate-pulse rounded-md bg-secondary",t.class))},null,2))}},je={__name:"ScrollBar",props:{orientation:{type:String,required:!1,default:"vertical"},forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(a){const t=a;return(i,d)=>(o(),g(e(Z),X(t,{class:e(L)("flex touch-none select-none transition-colors",a.orientation==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a.orientation==="horizontal"&&"h-2.5 border-t border-t-transparent p-[1px]",i.$attrs.class??"")}),{default:l(()=>[s(e(Q),{class:"relative flex-1 rounded-full bg-border"})]),_:1},16,["class"]))}},Ee={__name:"ScrollArea",props:{type:{type:String,required:!1},dir:{type:String,required:!1},scrollHideDelay:{type:Number,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},class:{type:String,required:!1,default:""}},setup(a){const t=a;return(i,d)=>(o(),g(e(le),{type:a.type,class:Y(e(L)("relative overflow-hidden",t.class))},{default:l(()=>[s(e(K),{class:"h-full w-full rounded-[inherit]"},{default:l(()=>[ee(i.$slots,"default")]),_:3}),s(je),s(e(se))]),_:3},8,["type","class"]))}},Te={props:["mapSongs","concertTitle"]};function Ue(a,t,i,d,c,m){return o(!0),u(y,null,S(i.mapSongs[i.concertTitle],_=>(o(),u("h6",{key:_.id,class:"py-4"},[f("span",null,p(_.id)+". ",1),f("span",null,p(_.name),1)]))),128)}const J=te(Te,[["render",Ue]]),{setIsLoading:H}=ae(),Ne=()=>{let a;const t=ne(null);return{state:a,err:t,httpData:async(d,c,m)=>(H(m),new Promise((_,$)=>{ie[d](c).then(C=>{a=C.data,_(a)}).catch(C=>{console.log(C),t.value=C,$(t)}).finally(()=>{H()})}))}},{httpData:ze}=Ne(),x=ce("songsStore",{state:()=>({selectReview:"未審閱",sortInitial:!0,controlCheckAll:!0,songCheckList:[],songs:[],backupDatas:[],mapSongs:{},userId1:{email:"1@gmail.com"}}),actions:{getSongs(a){ze("get",a).then(t=>{for(const i of t.data)i.id=i.id.toString();this.songs=[...t.data],this.backupDatas=[...t.data],this.mapSongs=Object.groupBy([...t.data],({concert:i})=>i.title)})},checkReview(a){const t=this.songs.find(i=>i.id===a);t.is_reviewed=!0},chagneCheckList(a){const t=this.songs.find(d=>d.id===a),i=this.songCheckList.findIndex(d=>d.id===a);i===-1?this.songCheckList.push(t):this.songCheckList.splice(i,1)},checkSelectReview(){this.controlCheckAll=!1;const a=document.querySelectorAll('[role="checkbox"]');this.songCheckList.forEach(t=>{this.checkReview(t.id)}),a.forEach(t=>{t.dataset.state==="checked"&&t.click()}),this.controlCheckAll=!0},checkAllList(){if(!this.controlCheckAll)return;const a=document.querySelectorAll('[role="checkbox"]');a.forEach((t,i)=>{if(i!==0){if(t.dataset.state!==a[0].dataset.state)return;t.click()}})},checkSelectReview(){this.controlCheckAll=!1;const a=document.querySelectorAll('[role="checkbox"]');this.songCheckList.forEach(t=>{this.checkReview(t.id)}),a.forEach(t=>{t.dataset.state==="checked"&&t.click()}),this.controlCheckAll=!0},deleteSelectReview(){this.controlCheckAll=!1;const a=document.querySelectorAll('[role="checkbox"]');this.songCheckList.forEach(t=>{this.deleteSong(t.id)}),a.forEach(t=>{t.dataset.state==="checked"&&t.click()}),this.controlCheckAll=!0,this.alertMessage("success","已刪除")},sortSongByDownVotes(){this.sortInitial=!this.sortInitial,this.sortInitial?this.songs.sort((a,t)=>a.down_votes-t.down_votes):this.songs.sort((a,t)=>t.down_votes-a.down_votes)},searchSong:we(function(a){if(this.songs=[...this.backupDatas],a.target.value==="")return;const t=new RegExp(a.target.value,"i"),i=this.songs.filter(c=>t.test(c.name)),d=this.songs.filter(()=>t.test(this.userId1.email));this.songs=[...i,...d]},500,{maxWait:2e3}),deleteSong(a){console.log(a);const t=this.songs.findIndex(i=>i.id===a);this.songs.splice(t,1),this.alertMessage("success","評論已刪除")},warnUser(a){console.log(a),this.deleteSong(a),this.alertMessage("success",`對${this.userId1.email}使用者警告已送出`)},alertMessage(a,t){oe.fire({icon:a,text:t})}},getters:{filterDatas(){return this.selectReview==="全部"?this.songs:this.selectReview==="未審閱"?this.songs.filter(a=>!a.is_reviewed):this.songs.filter(a=>a.is_reviewed)}}}),Me={class:"grid grid-cols-1 lg:grid-cols-5 gap-4 mb-8"},Ge={class:"col-span-2 lg:col-span-1"},Oe={class:"flex col-span-2"},Pe=f("span",{class:"material-symbols-outlined absolute"}," search ",-1),We={class:"flex flex-wrap space-y-4 sm:space-y-0 col-span-2 items-center justify-between"},Fe={key:0},He={key:1},Ye={key:0,class:"material-symbols-outlined"},Je={key:1,class:"material-symbols-outlined"},Qe=["for"],Xe=f("span",{class:"material-symbols-outlined"},"delete",-1),Ze={class:"flex justify-center"},Ke={components:{SongList:J},data(){return{userId1:{email:"1@gmail.com"}}},inject:["http","path"],methods:{...re(x,["getSongs","checkReview","checkSelectReview","chagneCheckList","checkAllList","searchSong","sortSongByDownVotes","deleteSong","warnUser","alertMessage","deleteSelectReview"])},computed:{...ue(x,["songs","mapSongs","songCheckList","sortInitial","filterDatas"]),...de(x,["selectReview"])},mounted(){this.getSongs(this.path.songs)}},rs=Object.assign(Ke,{__name:"AdminPlaylistsView",setup(a){return(t,i)=>{const d=ge("router-link");return o(),u(y,null,[f("div",Me,[f("div",Ge,[s(e(V),{modelValue:t.selectReview,"onUpdate:modelValue":i[0]||(i[0]=c=>t.selectReview=c)},{default:l(()=>[s(e(D),null,{default:l(()=>[s(e(R),{placeholder:"未審閱"})]),_:1}),s(e(B),null,{default:l(()=>[s(e(I),null,{default:l(()=>[s(e(q),null,{default:l(()=>[n("評論審閱")]),_:1}),s(e(w),{value:"未審閱"},{default:l(()=>[n(" 未審閱 ")]),_:1}),s(e(w),{value:"已審閱"},{default:l(()=>[n(" 已審閱 ")]),_:1}),s(e(w),{value:"全部"},{default:l(()=>[n(" 全部 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),f("div",Oe,[s(e(Se),{type:"text",placeholder:"輸入會場、用戶名稱查詢...",onInput:t.searchSong,class:"bg-white rounded-r-none border h-10 px-2 w-full focus-visible:ring-offset-0"},null,8,["onInput"]),s(e(h),{class:"rounded-l-none"},{default:l(()=>[Pe]),_:1})]),f("div",We,[f("p",null,"列表數量: "+p(t.filterDatas.length),1),f("div",null,[s(e(h),{class:"bg-lime-500 hover:bg-lime-700",onClick:t.checkSelectReview},{default:l(()=>[n("已審閱")]),_:1},8,["onClick"]),s(e(qe),null,{default:l(()=>[s(e(Re),null,{default:l(()=>[s(e(h),{class:"ml-4",variant:"destructive"},{default:l(()=>[n("刪除")]),_:1})]),_:1}),s(e(Be),null,{default:l(()=>[t.songCheckList.length?(o(),u("div",Fe,[s(e(j),null,{default:l(()=>[s(e(E),null,{default:l(()=>[n("是否刪除以下歌曲")]),_:1}),s(e(T),null,{default:l(()=>[(o(!0),u(y,null,S(t.songCheckList,c=>(o(),u("p",{key:c.id},p(c.name),1))),128))]),_:1})]),_:1}),s(e(U),null,{default:l(()=>[s(e(N),null,{default:l(()=>[n("Cancel")]),_:1}),s(e(Ie),{onClick:t.deleteSelectReview},{default:l(()=>[n("Continue")]),_:1},8,["onClick"])]),_:1})])):(o(),u("div",He,[s(e(j),null,{default:l(()=>[s(e(E),{class:"text-center"},{default:l(()=>[n("請先點取核取方塊")]),_:1}),s(e(T))]),_:1}),s(e(U),null,{default:l(()=>[s(e(N),null,{default:l(()=>[n("Cancel")]),_:1})]),_:1})]))]),_:1})]),_:1})])])]),fe(s(e(Ae),{class:"bg-white rounded-lg text-md mb-10"},{default:l(()=>[s(e(De),null,{default:l(()=>[n("歌單管理控制面板")]),_:1}),s(e(xe),null,{default:l(()=>[s(e(b),{class:"hover:bg-white",style:{color:"black !important"}},{default:l(()=>[s(e(k),null,{default:l(()=>[s(e(A),{onClick:t.checkAllList},null,8,["onClick"])]),_:1}),s(e(k),null,{default:l(()=>[s(e(h),{variant:"ghost",onClick:t.sortSongByDownVotes},{default:l(()=>[n("倒推人數"),t.sortInitial?(o(),u("span",Ye," stat_1 ")):(o(),u("span",Je," stat_minus_1 "))]),_:1},8,["onClick"])]),_:1}),s(e(k),null,{default:l(()=>[n("歌曲")]),_:1}),s(e(k),null,{default:l(()=>[n("全部歌單")]),_:1}),s(e(k),null,{default:l(()=>[n("演唱會")]),_:1}),s(e(k),null,{default:l(()=>[n("用戶名")]),_:1}),s(e(k))]),_:1})]),_:1}),s(e(Le),{class:"text-gray-600"},{default:l(()=>[(o(),g(he,null,{default:l(()=>[(o(!0),u(y,null,S(t.filterDatas,c=>(o(),g(e(b),{class:"py-8",key:c.id},{default:l(()=>[s(e(r),{class:"text-purple-primary"},{default:l(()=>[s(e(A),{id:c.id,onClick:m=>t.chagneCheckList(c.id),class:"checkboxList"},null,8,["id","onClick"]),f("label",{for:c.id,class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},null,8,Qe)]),_:2},1024),s(e(r),{class:"text-purple-primary text-center"},{default:l(()=>[n(p(c.down_votes),1)]),_:2},1024),s(e(r),null,{default:l(()=>[n(p(c.name),1)]),_:2},1024),s(e(r),null,{default:l(()=>[s(e(z),null,{default:l(()=>[s(e(M),null,{default:l(()=>[s(e(h),null,{default:l(()=>[n(" 檢視 ")]),_:1})]),_:1}),s(e(G),{class:"p-12"},{default:l(()=>[s(e(O),{class:"border-b-2 pb-4"},{default:l(()=>[s(e(P),null,{default:l(()=>[n(p(c.concert.title),1)]),_:2},1024),s(e(W),null,{default:l(()=>[n(" 歌單列表 ")]),_:1})]),_:2},1024),s(e(Ee),{class:"h-[300px] rounded-md border p-4"},{default:l(()=>[s(J,{mapSongs:t.mapSongs,concertTitle:c.concert.title},null,8,["mapSongs","concertTitle"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),s(e(r),null,{default:l(()=>[s(d,{class:"text-purple-500 hover:text-purple-800",to:"/concert/4"},{default:l(()=>[n(p(c.concert.title),1)]),_:2},1024)]),_:2},1024),s(e(r),null,{default:l(()=>[n(p(t.userId1.email),1)]),_:1}),s(e(r),{class:"space-x-4 flex"},{default:l(()=>[c.is_reviewed?(o(),g(e(h),{key:1,class:"bg-lime-500"},{default:l(()=>[n("已審閱")]),_:1})):(o(),g(e(h),{key:0,class:"bg-gray-200",onClick:m=>t.checkReview(c.id)},{default:l(()=>[n("未審閱")]),_:2},1032,["onClick"])),s(e(z),null,{default:l(()=>[s(e(M),null,{default:l(()=>[s(e(h),{variant:"destructive"},{default:l(()=>[Xe]),_:1})]),_:1}),s(e(G),null,{default:l(()=>[s(e(O),null,{default:l(()=>[s(e(P),{class:"text-center"},{default:l(()=>[n("是否要警告使用者？")]),_:1}),s(e(W),null,{default:l(()=>[s(e(V),null,{default:l(()=>[s(e(D),null,{default:l(()=>[s(e(R),{placeholder:"警告原因"})]),_:1}),s(e(B),null,{default:l(()=>[s(e(I),null,{default:l(()=>[s(e(q),null,{default:l(()=>[n("警告原因")]),_:1}),s(e(w),{value:"不實評論"},{default:l(()=>[n(" 不實評論 ")]),_:1}),s(e(w),{value:"惡意評論"},{default:l(()=>[n(" 惡意評論 ")]),_:1}),s(e(w),{value:"腥羶色內容"},{default:l(()=>[n(" 腥羶色內容 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(e(Ve),null,{default:l(()=>[s(e(F),null,{default:l(()=>[s(e(h),{class:"bg-lime-500",onClick:m=>t.deleteSong(c.id)},{default:l(()=>[n("不警告")]),_:2},1032,["onClick"])]),_:2},1024),s(e(F),null,{default:l(()=>[s(e(h),{variant:"destructive",onClick:m=>t.warnUser(c.userId1)},{default:l(()=>[n("送出警告")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),fallback:l(()=>[(o(),u(y,null,S(10,c=>s(e(b),{class:"py-8",key:c},{default:l(()=>[s(e(r),{class:"text-purple-primary"},{default:l(()=>[s(e(v),{class:"size-5 rounded-xl"})]),_:1}),s(e(r),{class:"text-purple-primary text-center"},{default:l(()=>[s(e(v),{class:"h-5"})]),_:1}),s(e(r),null,{default:l(()=>[s(e(v),{class:"h-5"})]),_:1}),s(e(r),null,{default:l(()=>[s(e(v),{class:"h-5"})]),_:1}),s(e(r),null,{default:l(()=>[s(e(v),{class:"h-5"})]),_:1}),s(e(r),null,{default:l(()=>[s(e(v),{class:"h-5"})]),_:1}),s(e(r),null,{default:l(()=>[s(e(v),{class:"h-5"})]),_:1})]),_:2},1024)),64))]),_:1}))]),_:1})]),_:1},512),[[_e,t.filterDatas.length!==0]]),f("div",Ze,[s(e(me),{total:100,"sibling-count":1,"show-edges":"","default-page":1},{default:l(({page:c})=>[s(e(pe),{class:"flex items-center md:gap-1"},{default:l(({items:m})=>[s(e(ve)),s(e($e)),(o(!0),u(y,null,S(m,(_,$)=>(o(),u(y,null,[_.type==="page"?(o(),g(e(ke),{key:$,value:_.value,"as-child":""},{default:l(()=>[s(e(h),{class:"w-10 h-10 p-0",variant:_.value===c?"default":"page"},{default:l(()=>[n(p(_.value),1)]),_:2},1032,["variant"])]),_:2},1032,["value"])):(o(),g(e(be),{key:_.type,index:$,class:"hidden sm:flex"},null,8,["index"]))],64))),256)),s(e(Ce)),s(e(ye))]),_:2},1024)]),_:1})])],64)}}});export{rs as default};
