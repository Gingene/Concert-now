import{j as $,aj as a,ai as r,a_ as P,ad as d,az as Y,aI as k,a8 as B}from"./index-IwGVorfi.js";import{h as g}from"./moment-WSJ9un1t.js";const D=()=>{let t;const e=$(null);return{state:t,err:e,timeCountryFilter:async(o,c="",l="",u="",m=1)=>{const h=c==="本日"?"day":c==="本週"?"week":"month",y=g().startOf(h).format("YYYY-MM-DD"),b=g().endOf(h).format("YYYY-MM-DD");let p=(o==="concerts"?a.concerts:a.artists)+"?";const v=`start=${y}&end=${b}`,C=`country=${l}`,w=`q=${u}`,x=`page=${m}`,s=[];return u!==""&&s.push(w),l!==""&&s.push(C),c!==""&&s.push(v),s.push(x),p+=s.join("&"),new Promise((S,F)=>{r.get(p).then(i=>{console.log(i),t=i.data,S(t)}).catch(i=>{console.log(i),e.value=i,F(e)})})}}};function T(){return{swalWithStylingButtons:P.mixin({customClass:{popup:"px-6 py-10 rounded-md bg-black-90 text-white text-nowrap",confirmButton:"mt-4 mr-2 whitespace-nowrap focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border-[3px] border-tiffany bg-tiffany text-primary p-2 md:py-2 md:px-4 lg:py-2 lg:px-6 rounded-btn1",cancelButton:"mt-4 ml-2 whitespace-nowrap focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border-[3px] border-black-80 bg-black-80 text-primary text-white p-2 md:py-2 md:px-4 lg:py-2 lg:px-6 rounded-btn1"},buttonsStyling:!1})}}const{timeCountryFilter:U}=D(),{getUserSavedAndFollowed:A}=d(),{swalWithStylingButtons:M}=T(),{setIsLoading:f}=Y(),O=k("concerts",{state:()=>({concerts:[],singleConcert:{},pagination:{},timeFactor:"",countryFactor:"",textFactor:"",pageFactor:""}),actions:{searchConcerts:B(function(t){this.textFactor=t,this.getConcerts()},300),getConcerts(t,e,n=1){t==="time"&&(e==="all"?this.timeFactor="":this.timeFactor=e),t==="country"&&(e==="all"?this.countryFactor="":this.countryFactor=e),this.pageFactor=n,U("concerts",this.timeFactor,this.countryFactor,this.textFactor,this.pageFactor).then(o=>{this.concerts=o.data,this.pagination=o.pagination}).then(()=>{})},getSingleConcert(t){f(),r.get(`${a.concerts}/${t}`).then(e=>{this.singleConcert=e.data.data}).then(()=>{f()}).catch(e=>{console.log(e)})},saveUnSavedConcert(t,e){r[t](`${a.concerts}/${e}/${t==="post"?"save":"unsave"}`).then(n=>{console.log(n)}).then(()=>{A()}).catch(n=>{console.log(n)})},callSaveAction(t){const{savedConcerts:e,AccessToken:n}=d();if(n===void 0){M.fire({title:"登入後才能用收藏功能喔！",showCancelButton:!0,confirmButtonText:"前往登入"}).then(o=>{o.isConfirmed&&(window.location.href="https://gingene.github.io/Concert-now/#/login")});return}[...e].some(o=>o.id===t)?this.saveUnSavedConcert("delete",t):this.saveUnSavedConcert("post",t)}}});export{T as a,O as u};
