import{o,a as k,w as t,d as s,u as e,U as W,t as F,v as O,V as Y,W as H,j as J,X as Q,O as X,Z,_ as K,c as _,B as $,F as y,e as r,C as h,l as ee,G as se,J as te,I as le,S as ae,m as ne,i as ie,Q as ce,R as b,T as x,f as n,g as f,L as oe,N as re,r as ue,Y as de}from"./index-dx1mPyCW.js";import{_ as fe,a as D,b as _e,c as he}from"./TableCaption-XQVZXoDf.js";import{u as me,_ as pe}from"./Input-7LSRXDAj.js";import{_ as ge,a as A,b as p,c as ke,e as ve,f as ye,g as we,d as g,h as Se}from"./TableRow-ewTkxG4d.js";import{_ as L,a as R,b as B,c as I,d as q,f as v,e as V}from"./SelectLabel-KD_FlYSn.js";import{_ as $e,a as Ce,b as be,c as xe,d as De,e as Ae,f as Le,g as Re,h as Be,i as j,j as E,k as T,l as U,m as N,n as M,o as Ie,p as z}from"./AlertDialogCancel-1Z1qFij9.js";import"./createLucideIcon-u4MERs3Q.js";import"./x-gVcJk1Kx.js";const qe={__name:"ScrollBar",props:{orientation:{type:String,required:!1,default:"vertical"},forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(a){const l=a;return(i,u)=>(o(),k(e(Y),F(l,{class:e(O)("flex touch-none select-none transition-colors",a.orientation==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a.orientation==="horizontal"&&"h-2.5 border-t border-t-transparent p-[1px]",i.$attrs.class??"")}),{default:t(()=>[s(e(W),{class:"relative flex-1 rounded-full bg-border"})]),_:1},16,["class"]))}},Ve={__name:"ScrollArea",props:{type:{type:String,required:!1},dir:{type:String,required:!1},scrollHideDelay:{type:Number,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},class:{type:String,required:!1,default:""}},setup(a){const l=a;return(i,u)=>(o(),k(e(Z),{type:a.type,class:X(e(O)("relative overflow-hidden",l.class))},{default:t(()=>[s(e(H),{class:"h-full w-full rounded-[inherit]"},{default:t(()=>[J(i.$slots,"default")]),_:3}),s(qe),s(e(Q))]),_:3},8,["type","class"]))}},je={props:["mapSongs","concertTitle"]};function Ee(a,l,i,u,c,m){return o(!0),_(y,null,$(i.mapSongs[i.concertTitle],d=>(o(),_("h6",{key:d.id,class:"py-4"},[r("span",null,h(d.id)+". ",1),r("span",null,h(d.name),1)]))),128)}const P=K(je,[["render",Ee]]),{setIsLoading:G}=ee(),Te=()=>{let a;const l=se(null);return{state:a,err:l,httpData:async(u,c,m)=>(G(m),new Promise((d,w)=>{te[u](c).then(S=>{a=S.data,d(a)}).catch(S=>{console.log(S),l.value=S,w(l)}).finally(()=>{G()})}))}},{httpData:Ue}=Te(),C=le("songsStore",{state:()=>({selectReview:"未審閱",sortInitial:!0,controlCheckAll:!0,songCheckList:[],songs:[],backupDatas:[],mapSongs:{},userId1:{email:"1@gmail.com"}}),actions:{getSongs(a){Ue("get",a).then(l=>{for(const i of l.data)i.id=i.id.toString();this.songs=[...l.data],this.backupDatas=[...l.data],this.mapSongs=Object.groupBy([...l.data],({concert:i})=>i.title)})},checkReview(a){const l=this.songs.find(i=>i.id===a);l.is_reviewed=!0},chagneCheckList(a){const l=this.songs.find(u=>u.id===a),i=this.songCheckList.findIndex(u=>u.id===a);i===-1?this.songCheckList.push(l):this.songCheckList.splice(i,1)},checkSelectReview(){this.controlCheckAll=!1;const a=document.querySelectorAll('[role="checkbox"]');this.songCheckList.forEach(l=>{this.checkReview(l.id)}),a.forEach(l=>{l.dataset.state==="checked"&&l.click()}),this.controlCheckAll=!0},checkAllList(){if(!this.controlCheckAll)return;const a=document.querySelectorAll('[role="checkbox"]');a.forEach((l,i)=>{if(i!==0){if(l.dataset.state!==a[0].dataset.state)return;l.click()}})},checkSelectReview(){this.controlCheckAll=!1;const a=document.querySelectorAll('[role="checkbox"]');this.songCheckList.forEach(l=>{this.checkReview(l.id)}),a.forEach(l=>{l.dataset.state==="checked"&&l.click()}),this.controlCheckAll=!0},deleteSelectReview(){this.controlCheckAll=!1;const a=document.querySelectorAll('[role="checkbox"]');this.songCheckList.forEach(l=>{this.deleteSong(l.id)}),a.forEach(l=>{l.dataset.state==="checked"&&l.click()}),this.controlCheckAll=!0,this.alertMessage("success","已刪除")},sortSongByDownVotes(){this.sortInitial=!this.sortInitial,this.sortInitial?this.songs.sort((a,l)=>a.down_votes-l.down_votes):this.songs.sort((a,l)=>l.down_votes-a.down_votes)},searchSong:me(function(a){if(this.songs=[...this.backupDatas],a.target.value==="")return;const l=new RegExp(a.target.value,"i"),i=this.songs.filter(c=>l.test(c.name)),u=this.songs.filter(()=>l.test(this.userId1.email));this.songs=[...i,...u]},500,{maxWait:2e3}),deleteSong(a){console.log(a);const l=this.songs.findIndex(i=>i.id===a);this.songs.splice(l,1),this.alertMessage("success","評論已刪除")},warnUser(a){console.log(a),this.deleteSong(a),this.alertMessage("success",`對${this.userId1.email}使用者警告已送出`)},alertMessage(a,l){ae.fire({icon:a,text:l})}},getters:{filterDatas(){return this.selectReview==="全部"?this.songs:this.selectReview==="未審閱"?this.songs.filter(a=>!a.is_reviewed):this.songs.filter(a=>a.is_reviewed)}}}),Ne={class:"grid grid-cols-1 lg:grid-cols-5 gap-4 mb-8"},Me={class:"col-span-2 lg:col-span-1"},ze={class:"flex col-span-2"},Ge=r("span",{class:"material-symbols-outlined absolute"}," search ",-1),Oe={class:"flex flex-wrap space-y-4 sm:space-y-0 col-span-2 items-center justify-between"},Pe={key:0,class:"material-symbols-outlined"},We={key:1,class:"material-symbols-outlined"},Fe=["for"],Ye=r("span",{class:"material-symbols-outlined"},"delete",-1),He={class:"flex justify-center py-12"},Je=r("h2",null,"哇! 找不到資料~",-1),Qe=[Je],Xe={class:"flex justify-center"},Ze={components:{SongList:P},data(){return{userId1:{email:"1@gmail.com"}}},inject:["http","path"],methods:{...ne(C,["getSongs","checkReview","checkSelectReview","chagneCheckList","checkAllList","searchSong","sortSongByDownVotes","deleteSong","warnUser","alertMessage","deleteSelectReview"])},computed:{...ie(C,["songs","mapSongs","songCheckList","sortInitial","filterDatas"]),...ce(C,["selectReview"])},mounted(){this.getSongs(this.path.songs)}},cs=Object.assign(Ze,{__name:"AdminPlaylistsView",setup(a){return(l,i)=>{const u=ue("router-link");return o(),_(y,null,[r("div",Ne,[r("div",Me,[s(e(V),{modelValue:l.selectReview,"onUpdate:modelValue":i[0]||(i[0]=c=>l.selectReview=c)},{default:t(()=>[s(e(L),null,{default:t(()=>[s(e(R),{placeholder:"未審閱"})]),_:1}),s(e(B),null,{default:t(()=>[s(e(I),null,{default:t(()=>[s(e(q),null,{default:t(()=>[n("評論審閱")]),_:1}),s(e(v),{value:"未審閱"},{default:t(()=>[n(" 未審閱 ")]),_:1}),s(e(v),{value:"已審閱"},{default:t(()=>[n(" 已審閱 ")]),_:1}),s(e(v),{value:"全部"},{default:t(()=>[n(" 全部 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),r("div",ze,[s(e(pe),{type:"text",placeholder:"輸入會場、用戶名稱查詢...",onInput:l.searchSong,class:"bg-white rounded-r-none border h-10 px-2 w-full focus-visible:ring-offset-0"},null,8,["onInput"]),s(e(f),{class:"rounded-l-none"},{default:t(()=>[Ge]),_:1})]),r("div",Oe,[r("p",null,"列表數量: "+h(l.filterDatas.length),1),r("div",null,[s(e(f),{class:"bg-lime-500",onClick:l.checkSelectReview},{default:t(()=>[n("已審閱")]),_:1},8,["onClick"]),s(e(Be),null,{default:t(()=>[s(e($e),null,{default:t(()=>[s(e(f),{class:"ml-4",variant:"destructive"},{default:t(()=>[n("刪除")]),_:1})]),_:1}),s(e(Ce),null,{default:t(()=>[s(e(be),null,{default:t(()=>[s(e(xe),null,{default:t(()=>[n("是否刪除以下歌曲")]),_:1}),s(e(De),null,{default:t(()=>[(o(!0),_(y,null,$(l.songCheckList,c=>(o(),_("p",{key:c.id},h(c.name),1))),128))]),_:1})]),_:1}),s(e(Ae),null,{default:t(()=>[s(e(Le),null,{default:t(()=>[n("Cancel")]),_:1}),s(e(Re),{onClick:l.deleteSelectReview},{default:t(()=>[n("Continue")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})])])]),b(s(e(ve),{class:"bg-white rounded-lg text-md mb-10"},{default:t(()=>[s(e(fe),null,{default:t(()=>[n("歌單管理控制面板")]),_:1}),s(e(ge),null,{default:t(()=>[s(e(A),{class:"hover:bg-white",style:{color:"black !important"}},{default:t(()=>[s(e(p),null,{default:t(()=>[s(e(D),{onClick:l.checkAllList},null,8,["onClick"])]),_:1}),s(e(p),null,{default:t(()=>[s(e(f),{variant:"ghost",onClick:l.sortSongByDownVotes},{default:t(()=>[n("倒推人數"),l.sortInitial?(o(),_("span",Pe," stat_1 ")):(o(),_("span",We," stat_minus_1 "))]),_:1},8,["onClick"])]),_:1}),s(e(p),null,{default:t(()=>[n("歌曲")]),_:1}),s(e(p),null,{default:t(()=>[n("全部歌單")]),_:1}),s(e(p),null,{default:t(()=>[n("演唱會")]),_:1}),s(e(p),null,{default:t(()=>[n("用戶名")]),_:1}),s(e(p))]),_:1})]),_:1}),s(e(ke),{class:"text-gray-600"},{default:t(()=>[(o(!0),_(y,null,$(l.filterDatas,c=>(o(),k(e(A),{class:"py-8",key:c.id},{default:t(()=>[s(e(g),{class:"text-purple-primary"},{default:t(()=>[s(e(D),{id:c.id,onClick:m=>l.chagneCheckList(c.id),class:"checkboxList"},null,8,["id","onClick"]),r("label",{for:c.id,class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},null,8,Fe)]),_:2},1024),s(e(g),{class:"text-purple-primary text-center"},{default:t(()=>[n(h(c.down_votes),1)]),_:2},1024),s(e(g),null,{default:t(()=>[n(h(c.name),1)]),_:2},1024),s(e(g),null,{default:t(()=>[s(e(j),null,{default:t(()=>[s(e(E),null,{default:t(()=>[s(e(f),null,{default:t(()=>[n(" 檢視 ")]),_:1})]),_:1}),s(e(T),{class:"p-12"},{default:t(()=>[s(e(U),{class:"border-b-2 pb-4"},{default:t(()=>[s(e(N),null,{default:t(()=>[n(h(c.concert.title),1)]),_:2},1024),s(e(M),null,{default:t(()=>[n(" 歌單列表 ")]),_:1})]),_:2},1024),s(e(Ve),{class:"h-[300px] rounded-md border p-4"},{default:t(()=>[s(P,{mapSongs:l.mapSongs,concertTitle:c.concert.title},null,8,["mapSongs","concertTitle"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),s(e(g),null,{default:t(()=>[s(u,{class:"text-purple-500 hover:text-purple-800",to:"/concert/4"},{default:t(()=>[n(h(c.concert.title),1)]),_:2},1024)]),_:2},1024),s(e(g),null,{default:t(()=>[n(h(l.userId1.email),1)]),_:1}),s(e(g),{class:"space-x-4 flex"},{default:t(()=>[c.is_reviewed?(o(),k(e(f),{key:1,class:"bg-lime-500"},{default:t(()=>[n("已審閱")]),_:1})):(o(),k(e(f),{key:0,class:"bg-gray-200",onClick:m=>l.checkReview(c.id)},{default:t(()=>[n("未審閱")]),_:2},1032,["onClick"])),s(e(j),null,{default:t(()=>[s(e(E),null,{default:t(()=>[s(e(f),{variant:"destructive"},{default:t(()=>[Ye]),_:1})]),_:1}),s(e(T),null,{default:t(()=>[s(e(U),null,{default:t(()=>[s(e(N),{class:"text-center"},{default:t(()=>[n("是否要警告使用者？")]),_:1}),s(e(M),null,{default:t(()=>[s(e(V),null,{default:t(()=>[s(e(L),null,{default:t(()=>[s(e(R),{placeholder:"警告原因"})]),_:1}),s(e(B),null,{default:t(()=>[s(e(I),null,{default:t(()=>[s(e(q),null,{default:t(()=>[n("警告原因")]),_:1}),s(e(v),{value:"不實評論"},{default:t(()=>[n(" 不實評論 ")]),_:1}),s(e(v),{value:"惡意評論"},{default:t(()=>[n(" 惡意評論 ")]),_:1}),s(e(v),{value:"腥羶色內容"},{default:t(()=>[n(" 腥羶色內容 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(e(Ie),null,{default:t(()=>[s(e(z),null,{default:t(()=>[s(e(f),{class:"bg-lime-500",onClick:m=>l.deleteSong(c.id)},{default:t(()=>[n("不警告")]),_:2},1032,["onClick"])]),_:2},1024),s(e(z),null,{default:t(()=>[s(e(f),{variant:"destructive",onClick:m=>l.warnUser(c.userId1)},{default:t(()=>[n("送出警告")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},512),[[x,l.filterDatas.length!==0]]),b(r("div",He,Qe,512),[[x,!l.filterDatas.length]]),r("div",Xe,[s(e(re),{total:100,"sibling-count":1,"show-edges":"","default-page":1},{default:t(({page:c})=>[s(e(oe),{class:"flex items-center md:gap-1"},{default:t(({items:m})=>[s(e(_e)),s(e(ye)),(o(!0),_(y,null,$(m,(d,w)=>(o(),_(y,null,[d.type==="page"?(o(),k(e(de),{key:w,value:d.value,"as-child":""},{default:t(()=>[s(e(f),{class:"w-10 h-10 p-0",variant:d.value===c?"default":"page"},{default:t(()=>[n(h(d.value),1)]),_:2},1032,["variant"])]),_:2},1032,["value"])):(o(),k(e(Se),{key:d.type,index:w,class:"hidden sm:flex"},null,8,["index"]))],64))),256)),s(e(we)),s(e(he))]),_:2},1024)]),_:1})])],64)}}});export{cs as default};
